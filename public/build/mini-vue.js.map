{"version":3,"file":"mini-vue.js","sources":["../../src/util/index.ts","../../src/runtime/vnode.ts","../../src/runtime/render.ts","../../src/test/2vnode.ts","../../src/index.ts"],"sourcesContent":["export function isObject(target) {\n    return typeof target === 'object' && target !== null;\n}\n\nexport function isReactive(target) {\n    return !!(target && target.__isReactive);\n}\n\nexport function hasChanged(oldValue, value) {\n    return oldValue !== value && !(Number.isNaN(oldValue) && Number.isNaN(value));\n}\n\nexport function isFunction(target) {\n    return typeof target === 'function';\n}\n\nexport function isString(target) {\n    return typeof target === 'string';\n}\n\nexport function isNumber(target) {\n    return typeof target === 'number';\n}\n\nexport function isBoolean(target) {\n    return typeof target === 'boolean';\n}","import { isNumber, isString } from \"../util\";\n\nexport const enum ShapeFlags {\n    ELEMENT = 1, // 00000001\n    TEXT = 1 << 1, // 00000010\n    FRAGMENT = 1 << 2, // 00000100\n    COMPONENT = 1 << 3, // 00001000\n    TEXT_CHILDREN = 1 << 4, // 00010000\n    ARRAY_CHILDREN = 1 << 5, // 00100000\n    CHILDREN = (1 << 4) | (1 << 5), //00110000\n};\n\nexport const Text = Symbol('Text');\nexport const Fragment = Symbol('Fragment');\n\nexport type VNode = {\n    type: any,\n    props: any | null,\n    children: string | any[] | number | null,\n    shapeFlag: ShapeFlags | 0\n}\n\nexport function h(type, props, children): VNode {\n    let shapeFlag: ShapeFlags | 0 = 0;\n    if(isString(type)) {\n        shapeFlag = ShapeFlags.ELEMENT;\n    } else if(type === Text) {\n        shapeFlag = ShapeFlags.TEXT;\n    } else if(type === Fragment) {\n        shapeFlag = ShapeFlags.FRAGMENT;\n    } else {\n        shapeFlag = ShapeFlags.COMPONENT;\n    }\n\n    if(isString(children) || isNumber(children)) {\n        shapeFlag |= ShapeFlags.TEXT_CHILDREN;\n        children = children.toString();\n    } else if(Array.isArray(children)) {\n        shapeFlag |= ShapeFlags.ARRAY_CHILDREN;\n    }\n    return {\n        type,\n        props,\n        children,\n        shapeFlag\n    }\n}","import { isBoolean } from \"../util\";\nimport { ShapeFlags, VNode } from \"./vnode\";\n\nexport function render(vnode: VNode, container) {\n    mount(vnode, container);\n}\n\nfunction mount(vnode: VNode, container) {\n    const { shapeFlag } = vnode;\n    if(shapeFlag & ShapeFlags.ELEMENT) {\n        mountElement(vnode, container);\n    } else if(shapeFlag & ShapeFlags.TEXT) {\n        mountTextNode(vnode, container);\n    } else if(shapeFlag & ShapeFlags.FRAGMENT) {\n        mountFragment(vnode, container);\n    } else {\n        mountComponent(vnode, container);\n    }\n}\n\nfunction mountElement(vnode: VNode, container: any) {\n    const { type, props, children } = vnode;\n    const el = document.createElement(type);\n    mountProps(props, el);\n    mountChildren(vnode, el);\n    container.appendChild(el);\n}\nfunction mountTextNode(vnode: VNode, container: any) {\n    const textNode = document.createTextNode(vnode.children as string);\n    container.appendChild(textNode);\n}\n\nfunction mountFragment(vnode: VNode, container: any) {\n    mountChildren(vnode, container);\n}\nfunction mountComponent(vnode: VNode, container: any) {\n    \n}\n\nconst domPropsRE = /[A-Z]|^(value|checked|selected|muted|disabled)$/;\nfunction mountProps(props: any, container: any) {\n    for(const key in props) {\n        let value = props[key];\n        if(key === 'class') {\n            container.className = value;\n        } else if(key === 'style') {\n            for(const styleName in value) {\n                container.style[styleName] = value[styleName];\n            }\n        } else {\n            if(/^on[^a-z]/.test(key)) {\n                const eventName = key.slice(2).toLowerCase();\n                container.addEventListener(eventName, value);\n            } else if(domPropsRE.test(key)) {\n                if(value === '' && isBoolean(container[key])) {\n                    value = true;\n                }\n                container[key] = value\n            } else {\n                if(value === null || value === false) {\n                    container.removeAttribute(key);\n                } else {\n                    container.setAttribute(key, value);\n                }\n            }\n        }\n    }\n}\n\nfunction mountChildren(vnode: VNode, container: any) {\n    const { shapeFlag, children } = vnode;\n    if(shapeFlag & ShapeFlags.TEXT_CHILDREN) {\n        mountTextNode(vnode, container)\n    } else if(shapeFlag & ShapeFlags.ARRAY_CHILDREN) {\n        (children as any[]).forEach(child => {\n            mount(child, container);\n        });\n    }\n}\n\n","import { h, Text, Fragment } from '../runtime/vnode';\nimport { render } from '../runtime/render';\n\nexport default function() {\n    render(h(\n        'div',\n        {\n            class: 'a b',\n            style: {\n              border: '1px solid',\n              fontSize: '14px',\n            },\n            onClick: () => console.log('click'),\n            checked: '',\n            custom: false,\n        }, [\n            h('ul', null, [\n                h('li', { style: { color: 'red' } }, 1),\n                h('li', null, 2),\n                h('li', { style: { color: 'blue' } }, 3),\n                h('li', null, [h(Text, null, 'hello world')]),\n            ]),\n        ]\n    ), document.body);\n}\n","import test1 from './test/1reactive';\nimport test2 from './test/2vnode';\n\ntest2();"],"names":[],"mappings":"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"}